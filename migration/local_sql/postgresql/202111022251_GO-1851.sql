--add system element for new column
INSERT INTO adempiere.ad_element (ad_element_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, columnname, entitytype, name, printname, description, help, po_name, po_printname, po_description, po_help, ad_element_uu, placeholder) VALUES ((SELECT MAX(ad_element_id) + 1 FROM ad_element),0, 0, 'Y', '2021-11-23 12:37:53.691000', 100, '2021-11-23 12:37:53.691000', 100, 'bh_update_reason', 'U', 'bh_update_reason', 'bh_update_reason', null, null, null, null, null, null, 'cf161a48-d2ff-4b2e-a45c-1a48f6ea88ef', null) ON CONFLICT DO NOTHING;
--Price update reference
INSERT INTO adempiere.ad_reference (ad_reference_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, name, description, help, validationtype, vformat, entitytype, isorderbyvalue, ad_reference_uu, ad_element_id)VALUES ((SELECT max(ad_reference_id) + 1 FROM adempiere.ad_reference), 0, 0, 'Y', '2021-11-02 22:06:41.838000', 100, '2021-11-02 22:10:52.692000', 100, 'BH_Inventory_Update_Reasons', 'List of reasons for updating product inventory', null, 'L', null, 'U', 'N', 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f', null) ON CONFLICT DO NOTHING;

--Price Update reasons ref-list
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:13:00.944000', 100, '2021-11-02 22:13:00.944000', 100, 'p_dmg', 'Damaged products', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', '315319b8-c274-414c-bb87-6d2d3e9f2acf', null, null) ON CONFLICT DO NOTHING;
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:16:09.679000', 100, '2021-11-02 22:16:09.679000', 100, 'p_exp', 'Product expired', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', '9070547d-c818-49da-a406-edd3999f9e05', null, null) ON CONFLICT DO NOTHING;
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:16:38.380000', 100, '2021-11-02 22:16:38.380000', 100, 'p_unc', 'Products used but not charged', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', '3dc79710-4a2b-4b58-9c8f-d557cf180c49', null, null) ON CONFLICT DO NOTHING;
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:17:05.962000', 100, '2021-11-02 22:17:05.962000', 100, 'p_los', 'Lost or stolen products', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', '044ba1a8-986a-46ec-baf6-4d6efcea1e48', null, null) ON CONFLICT DO NOTHING;
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:17:32.369000', 100, '2021-11-02 22:17:32.369000', 100, 'p_sna', 'System unavailable at sale', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', 'ab87230f-f137-454c-bba2-cd3a60fab3cb', null, null) ON CONFLICT DO NOTHING;
INSERT INTO adempiere.ad_ref_list (ad_ref_list_id, ad_client_id, ad_org_id, isactive, created, createdby, updated, updatedby, value, name, description, ad_reference_id, validfrom, validto, entitytype, ad_ref_list_uu, bh_update_existing, bh_add_all) VALUES ((SELECT max(ad_ref_list_id) + 1 FROM adempiere.ad_ref_list), 0, 0, 'Y', '2021-11-02 22:12:31.056000', 100, '2021-11-02 22:18:19.575000', 100, 'p_bqt', 'Wrong quantity received', null, (SELECT ad_reference_id FROM ad_reference WHERE ad_reference_uu = 'dcdc79d7-8e55-428f-a8a5-e7a6f562404f'), null, null, 'U', '982d9571-dc08-4335-a379-041403048053', null, null) ON CONFLICT DO NOTHING;

--add column to hold reason IDs for inventory updates
alter table m_inventory
add column if not exists bh_update_reason varchar(10);

SELECT register_migration_script('202111022251_GO-1851.sql') FROM dual;
