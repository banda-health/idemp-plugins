# BandaGo Plug-ins Project | ![TeamCity build status](https://teamcity.bandahealth.org/app/rest/builds/buildType:id:BHGO_Plugins_BuildDevelop/statusIcon.svg)
A repository that houses all Banda Health's plugins for iDempiere.

This resolves all BandaGo plugin dependencies and builds the deployment artifacts.
The included plugins are: 
* idemp-base
* idemp-base-editor
* idemp-webui
* idemp-rest

## Building the Project
To build all BandaGo projects, run:
```
mvn verify -Didempiere.home.dir=<absolute_path_to_idemp_repo/>
```
Example: 
`mvn verify -Didempiere.home.dir=/home/user1/idempiere/`

You can also configure your global settings so you don't have to provide the property each time. In your global settings file, set:
```
<settings ...>
  ...
  <profiles>
  <profile>
    <id>local-idempiere</id>
    <properties>
      <idempiere.home.dir>/home/user1/idempiere/</idempiere.home.dir>
    </properties>
  </profile>
  </profiles>
</settings>
```

## Running Tests
A database (DB) is needed to run tests (we test business logic, not implementation logic). You can either use your own and have test data be filled in it, or you can use a fresh DB. The Banda Health iDempiere image comes with data to initialize a new DB, if you'd like. Check the `.env.default` file for information that's available, plus the [Banda iDempiere Docker Image Repo](https://github.com/banda-health/idempiere-docker) for full image information.

### Base Plugin & Report Testing
For the base plugin tests and for reports, you can run them
1. Through the UI or
2. Through Docker compose

In the UI, log in as the Garden World client and search for `Populate` to see the screen appear. You can enter the number of loops and an optional package for your tests. This is based off [Chuck's testing framework](https://erp-academy.chuckboecking.com/?page_id=3711).

To run through Docker compose, simply build the plugins and run `docker compose up` to run the tests. Any container that doesn't finish running in a healthy state had tests fail.

### Rest API Tests
These are run via Jest to connect to the server and test the endpoints. It is a TypeScript project that needs the types the API returns. These are automatically generated by building the `idemp-rest` plugin, so please do that first.

You can spin up the Docker container to run these tests, or you can run them on your machine if you provide the following environment variables for connecting:
* `IDEMPIERE_ENDPOINT`
* `IDEMPIERE_USER`
* `IDEMPIERE_USER_PASSWORD`

Then just run the tests via the Jest CLI.
