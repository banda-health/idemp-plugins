<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.8.0.final using JasperReports Library version 6.8.0-2ed8dfabb690ff337a5797129f2cd92902b0c87b  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="productsAndPrices" pageWidth="600" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="600" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" isIgnorePagination="true" uuid="fc97a963-c0b6-4c19-a348-7e2773e092a3">
	<property name="template.engine" value="tabular_template"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="LatestUAT"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<style name="Table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
			<topPen lineWidth="1.0" lineColor="#000000"/>
			<leftPen lineWidth="1.0" lineColor="#000000"/>
			<bottomPen lineWidth="1.0" lineColor="#000000"/>
			<rightPen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#EFEFEF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="tableDataset" uuid="3372831f-d404-4f56-be99-156ec47ef21d">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="postgre UAT"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<parameter name="AD_CLIENT_ID" class="java.lang.Integer"/>
		<parameter name="AD_ORG_ID" class="java.lang.Integer"/>
		<queryString language="SQL">
			<![CDATA[WITH inventory_changes AS (
	SELECT
		m_product_id,
		purchase_price,
	    purchase_date,
	    row_number() over (partition by m_product_id ORDER BY purchase_date DESC) as rownum
	FROM
		get_inventory_changes($P{AD_CLIENT_ID})
    GROUP BY m_product_id,purchase_price,purchase_date
)
SELECT
	p.name               AS drugName,
	purchase_price       AS buyingPrice,
	productSP.SalesPrice AS sellingPrice
FROM
	m_product p
		JOIN inventory_changes ic
			ON p.m_product_id = ic.m_product_id
		LEFT JOIN
		(
			SELECT
				productPrice.m_product_id,
				productPrice.pricestd AS SalesPrice
			FROM
				m_pricelist priceList
					INNER JOIN m_pricelist_version priceListVersion
						ON priceList.m_pricelist_id = priceListVersion.m_pricelist_id
					INNER JOIN m_productprice productPrice
						ON priceListVersion.m_pricelist_version_id = productPrice.m_pricelist_version_id
			WHERE
				priceList.issopricelist = 'Y'
				AND priceList.isdefault = 'Y'
		) AS productSP
				ON p.m_product_id = productSP.m_product_id
WHERE
	ic.purchase_price IS NOT NULL
and
    ic.rownum = 1
ORDER BY
	p.name;]]>
		</queryString>
		<field name="drugname" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="drugname"/>
		</field>
		<field name="buyingprice" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="buyingprice"/>
		</field>
		<field name="sellingprice" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="sellingprice"/>
		</field>
	</subDataset>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer" isForPrompting="false"/>
	<parameter name="AD_ORG_ID" class="java.lang.Integer" isForPrompting="false"/>
	<queryString>
		<![CDATA[select
  org.ad_client_id as clientID,
  org.ad_org_id as orgID,
  org.name as org_name
from ad_org org
  where org.ad_client_id in ($P{AD_CLIENT_ID}) and org.ad_org_id in ($P{AD_CLIENT_ID});]]>
	</queryString>
	<field name="clientid" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="clientid"/>
	</field>
	<field name="orgid" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="orgid"/>
	</field>
	<field name="org_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="org_name"/>
	</field>
	<title>
		<band height="30" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="0" width="600" height="30" uuid="a03a3fd6-d4d1-42c9-9965-c5c8d1f74edc"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="22"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{org_name}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<summary>
		<band height="40" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<componentElement>
				<reportElement x="0" y="0" width="600" height="40" uuid="ac085adf-ab78-4b56-91e8-6aa088223212">
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table_TD"/>
					<property name="net.sf.jasperreports.export.headertoolbar.table.name" value=""/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="tableDataset" uuid="0e9a2ef2-8ee3-4aaa-8773-c61dd8cf5de2">
						<datasetParameter name="AD_CLIENT_ID">
							<datasetParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="AD_ORG_ID">
							<datasetParameterExpression><![CDATA[$P{AD_ORG_ID}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="340" uuid="62cf27d6-779e-452c-859b-6e25704bb5c5">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:columnHeader style="Table_CH" height="17">
							<property name="com.jaspersoft.studio.unit.height" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="340" height="17" uuid="5dfdd2b6-3808-4864-be42-bfa307b54196"/>
								<box leftPadding="2"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="17">
							<property name="com.jaspersoft.studio.unit.height" value="px"/>
							<textField>
								<reportElement x="0" y="0" width="340" height="17" uuid="85b65d72-cdc3-4815-8ce9-e7486d3d5a0c"/>
								<box leftPadding="2"/>
								<textElement verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12"/>
									<paragraph leftIndent="10"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{drugname}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="130" uuid="0949bef7-4c07-49f9-9d6c-e238613ebf74">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:columnHeader style="Table_CH" height="17">
							<staticText>
								<reportElement x="0" y="0" width="130" height="17" uuid="ce86be1f-c157-4cd2-a03b-723cfef8488c"/>
								<box leftPadding="2"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Last Buying Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="17">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="130" height="17" uuid="239ea122-a85f-4dcf-84c4-3efbb41c0a0d"/>
								<box leftPadding="2"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12"/>
									<paragraph rightIndent="10"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{buyingprice}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="130" uuid="8dbf0d24-37ee-4690-ae4d-19487ce1ffa5">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column3"/>
						<jr:columnHeader style="Table_CH" height="17">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="130" height="17" uuid="2d34d4a0-ab05-4aea-aae1-ae0f5bc1aece"/>
								<box leftPadding="2"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Selling Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="17">
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="130" height="17" uuid="5176c876-d23d-4b0b-acb6-f37d99a0762d"/>
								<box leftPadding="2"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="DejaVu Sans" size="12"/>
									<paragraph rightIndent="10"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{sellingprice}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</summary>
</jasperReport>
