<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.8.0.final using JasperReports Library version 6.8.0-2ed8dfabb690ff337a5797129f2cd92902b0c87b  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Inventory Quantity Report" pageWidth="690" pageHeight="560" orientation="Landscape" columnWidth="650" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="0" isIgnorePagination="true" uuid="4be505b3-b659-4b25-bbd1-32ac8fa76b69">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="LocalDB Adapter"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Stock" uuid="8ae6c1bf-fc0e-4492-9963-9f1ff3cf188d">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="LocalDB Adapter"/>
		<parameter name="Begin Date" class="java.util.Date"/>
		<parameter name="End Date" class="java.util.Date"/>
		<parameter name="AD_CLIENT_ID" class="java.lang.Integer"/>
		<queryString language="SQL">
			<![CDATA[select productname.product                           as item_name,
       coalesce(sum(currentqty.closingqty), 0)       as endingstock,
       coalesce(sum(stockreceived.qtyreceived), 0)   as receivedstock,
       coalesce(sum(stocksold.qtysold), 0)           as soldstock,
       coalesce(sum(stocktakechange.qtybalanced), 0) as balancestock,
       coalesce(sum(changesinqty.qtychanged), 0)     as changedstock
from (
         select m_product_id,
                product
         from bh_stocktake_v
         where ad_client_id = $P{AD_CLIENT_ID}
         group by m_product_id, product
     ) as productname
         left join
     (
         select m_product_id,
                sum(qtyonhand) as closingqty
         from m_product_stock_v
         where ad_client_id = $P{AD_CLIENT_ID}
           and isactive = 'Y'
           and (date (updated) <= date($P{End Date}))
         group by m_product_id
     ) as currentqty on currentqty.m_product_id = productname.m_product_id
         left join
     (
         select m_product_id,
                sum(movementqty) as qtychanged
         from m_transaction
         where ad_client_id = $P{AD_CLIENT_ID}
           and m_attributesetinstance_id <> 0
           and movementtype not in ('C-'
             , 'I+')
            and (date (movementdate) BETWEEN date($P{Begin Date}) AND date($P{End Date}))
         group by m_product_id
     ) as changesinqty on currentqty.m_product_id = changesinqty.m_product_id
         left join
     (
         select m_product_id,
                sum(movementqty) as qtyreceived
         from m_transaction
         where ad_client_id = $P{AD_CLIENT_ID}
           and movementtype = 'V+'
            and (date (movementdate) BETWEEN date($P{Begin Date}) AND date($P{End Date}))
         group by m_product_id
     ) as stockreceived on currentqty.m_product_id = stockreceived.m_product_id
         left join
     (
         select m_product_id,
                sum(movementqty) as qtybalanced
         from m_transaction
         where ad_client_id = $P{AD_CLIENT_ID}
           and movementtype in ('P+'
             , 'P-')
           and (date (movementdate) BETWEEN date($P{Begin Date}) AND date($P{End Date}))
         group by m_product_id
     ) as stocktakechange on currentqty.m_product_id = stocktakechange.m_product_id
         left join
     (
         select inoutline.m_product_id,
                sum(inoutline.movementqty) as qtysold
         from m_inoutline inoutline
                  inner join m_inout inout on inoutline.m_inout_id = inout.m_inout_id
         where inoutline.ad_client_id = $P{AD_CLIENT_ID}
           and inout.movementtype = 'C-'
             and (date (movementdate) BETWEEN date($P{Begin Date}) AND date($P{End Date}))
         group by inoutline.m_product_id
     ) as stocksold on currentqty.m_product_id = stocksold.m_product_id
group by item_name;]]>
		</queryString>
		<field name="item_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="item_name"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="bh_stocktake_v"/>
		</field>
		<field name="changedstock" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="changedstock"/>
		</field>
		<field name="receivedstock" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="receivedstock"/>
		</field>
		<field name="soldstock" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="soldstock"/>
		</field>
		<field name="balancestock" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="balancestock"/>
		</field>
		<field name="endingstock" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="endingstock"/>
		</field>
		<variable name="stockchanges" class="java.math.BigDecimal">
			<variableExpression><![CDATA[$F{changedstock}.subtract($F{soldstock})]]></variableExpression>
			<initialValueExpression><![CDATA[0]]></initialValueExpression>
		</variable>
		<variable name="endstock" class="java.math.BigDecimal">
			<variableExpression><![CDATA[$F{endingstock}]]></variableExpression>
		</variable>
		<group name="item_name">
			<groupExpression><![CDATA[$F{item_name}]]></groupExpression>
		</group>
	</subDataset>
	<parameter name="Begin Date" class="java.util.Date"/>
	<parameter name="End Date" class="java.util.Date"/>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer" isForPrompting="false"/>
	<queryString language="SQL">
		<![CDATA[select currentqty.product as item_name
from (
         select m_product_id,
                product
         from bh_stocktake_v
         where ad_client_id = $P{AD_CLIENT_ID}
         group by m_product_id, product
     ) as currentqty
inner join
    (
select m_product_id,
       sum(movementqty) as qtychanged
from m_transaction
where ad_client_id =  $P{AD_CLIENT_ID}
    and (date(movementdate) BETWEEN date($P{Begin Date}) AND date($P{End Date}))
group by m_product_id
        ) as changesinqty on currentqty.m_product_id = changesinqty.m_product_id
group by item_name
limit 1;]]>
	</queryString>
	<field name="item_name" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="4" splitType="Stretch">
			<textField>
				<reportElement x="-20" y="-20" width="690" height="20" uuid="e15c7778-5ecc-4d03-9d32-155cc9acde00">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box topPadding="0" leftPadding="5" bottomPadding="0" rightPadding="0">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Inventory Quantity Report Between " + new SimpleDateFormat("dd MMM yyyy").format($P{Begin Date}) + " and " + new SimpleDateFormat("dd MMM yyyy").format($P{End Date})]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="31" splitType="Stretch">
			<componentElement>
				<reportElement x="-20" y="-4" width="690" height="35" uuid="6509a834-8c0f-4138-862a-da9b39039be0">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table_TD"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" whenNoDataType="AllSectionsNoDetail">
					<datasetRun subDataset="Stock" uuid="70f57161-d1f6-4df2-92bf-fa8307472457">
						<datasetParameter name="Begin Date">
							<datasetParameterExpression><![CDATA[$P{Begin Date}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="End Date">
							<datasetParameterExpression><![CDATA[$P{End Date}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="AD_CLIENT_ID">
							<datasetParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="290" uuid="0f650f55-4604-471a-8b10-ba9ebcf6fc4d">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="290" height="20" uuid="34b3d9d2-92b2-4cc7-8312-2e3b0180cdef"/>
								<box leftPadding="5"/>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField>
								<reportElement x="0" y="0" width="290" height="15" uuid="f09bb270-2c76-4868-8c8d-18c10a2fb26d">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
								</reportElement>
								<box leftPadding="5"/>
								<textElement textAlignment="Left" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{item_name}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="c4c9a626-b34d-4581-b387-396b9b48debd">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="80" height="20" uuid="54bf6036-713f-4de3-9a86-30b2bfba39a6">
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Opening]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField pattern="#,##0">
								<reportElement x="0" y="0" width="80" height="15" uuid="cb1d5788-a38a-43be-bc03-19210c8c032f">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{endstock}.subtract($V{stockchanges})]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="99b19b1a-b622-4e80-b7cb-b4e4ed3b6c7b">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column3"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="80" height="20" uuid="fa7f7466-7c2b-482c-a8b4-dae00d42cb48">
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Received]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField pattern="#,##0">
								<reportElement x="0" y="0" width="80" height="15" uuid="2d48b555-aa60-488b-a173-f950c2003016">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{receivedstock}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="0aeb7452-8669-42f7-9883-f4d7f9906e46">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column4"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="80" height="20" uuid="6c2f161a-7a2e-41a9-a4cb-57521aef0f51">
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sold]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField pattern="#,##0">
								<reportElement x="0" y="0" width="80" height="15" uuid="d94da79e-491a-4c38-bbc6-e3012a19aa33">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{soldstock}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="060ac483-1ee6-4100-829a-3a19665f7389">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column5"/>
						<jr:tableFooter style="Table_TH" height="2" rowSpan="1"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="80" height="20" uuid="2293e0c9-3eb5-4888-80c7-d3f0191ff693">
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Balanced]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField pattern="#,##0">
								<reportElement x="0" y="0" width="80" height="15" uuid="17a2611d-0f9d-45ee-908c-d880c9bc2dc3">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{balancestock}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="3de712d5-7b4a-4091-b168-b39b734f7757">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column6"/>
						<jr:tableFooter style="Table_TH" height="2" rowSpan="1"/>
						<jr:columnHeader style="Table_CH" height="20" rowSpan="1">
							<staticText>
								<reportElement x="0" y="0" width="80" height="20" uuid="87cf9a7f-5df1-4059-b181-f32699b29d60">
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Closing]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="15">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField pattern="#,##0">
								<reportElement x="0" y="0" width="80" height="15" uuid="84809035-edb9-44ef-8084-46ad314a7655">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
									<property name="com.jaspersoft.studio.unit.width" value="px"/>
								</reportElement>
								<box rightPadding="5"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{endingstock}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</detail>
</jasperReport>
